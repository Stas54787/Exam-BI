<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.5, maximum-scale=3.0" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            text-align: center;
        }

        .logo {
            width: 64px;
            height: 64px;
            border-radius: 12px;
            border: 2px solid #fc403a1a;
            margin-bottom: 20px;
        }

        h1 {
            color: #333;
            font-size: 2rem;
            margin-bottom: 30px;
            font-weight: 700;
        }

        .progress-section {
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 14px;
            background: #eee;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(252,64,58,0.08);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fc403a 0%, #130909 100%);
            width: 0%;
            border-radius: 8px;
            transition: width 0.5s;
        }

        .stats h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .stats-grid {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: stretch;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
            cursor: default;
            width: 150px;
            height: 80px;
            background-image: linear-gradient(to top, #D8D9DB 0%, #fff 80%, #FDFDFD 100%);
            border-radius: 30px;
            border: 1px solid #8F9092;
            font-family: "Source Sans Pro", sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #606060;
            text-shadow: 0 1px #fff;
            flex-direction: column;
            padding: 10px;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 800;
            color: #fc403a;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            text-align: center;
            line-height: 1.2;
        }

        .stats-progress-bar {
            width: 100%;
            height: 14px;
            background: #eee;
            border-radius: 8px;
            margin: 18px 0 8px 0;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(252,64,58,0.08);
        }

        .stats-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fc403a 0%, #130909 100%);
            width: 0%;
            border-radius: 8px;
            transition: width 0.5s;
        }

        .exam-section {
            display: none;
        }

        .question-card {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .question-type {
            color: #666;
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .question-text {
            color: #333;
            font-size: 1.2rem;
            line-height: 1.6;
            font-weight: 500;
        }

        .evaluator-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }

        .evaluator-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .evaluation-result {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .result-correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .result-incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .evaluation-buttons {
            display: flex;
            flex-direction: row !important;
            gap: 15px;
            justify-content: center;
            align-items: center;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 120px;
        }

        .btn-correct {
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
            cursor: pointer;
            width: 150px;
            height: 50px;
            background-image: linear-gradient(to top, #90EE90 0%, #98FB98 80%, #F0FFF0 100%);
            border-radius: 30px;
            border: 1px solid #228B22;
            transition: all 0.2s ease;
            font-family: "Source Sans Pro", sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #006400;
            text-shadow: 0 1px #fff;
        }

        .btn-correct:hover {
            box-shadow: 0 4px 3px 1px #F0FFF0, 0 6px 8px #90EE90, 0 -4px 4px #228B22, 0 -6px 4px #F0FFF0, inset 0 0 3px 3px #90EE90;
        }

        .btn-correct:active {
            box-shadow: 0 4px 3px 1px #F0FFF0, 0 6px 8px #90EE90, 0 -4px 4px #228B22, 0 -6px 4px #F0FFF0, inset 0 0 5px 3px #228B22, inset 0 0 30px #90EE90;
        }

        .btn-correct:focus {
            box-shadow: 0 4px 3px 1px #F0FFF0, 0 6px 8px #90EE90, 0 -4px 4px #228B22, 0 -6px 4px #F0FFF0, inset 0 0 5px 3px #228B22, inset 0 0 30px #90EE90;
        }

        .btn-incorrect {
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
            cursor: pointer;
            width: 150px;
            height: 50px;
            background-image: linear-gradient(to top, #FFB6C1 0%, #FFC0CB 80%, #FFF0F5 100%);
            border-radius: 30px;
            border: 1px solid #DC143C;
            transition: all 0.2s ease;
            font-family: "Source Sans Pro", sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #8B0000;
            text-shadow: 0 1px #fff;
        }

        .btn-incorrect:hover {
            box-shadow: 0 4px 3px 1px #FFF0F5, 0 6px 8px #FFB6C1, 0 -4px 4px #DC143C, 0 -6px 4px #FFF0F5, inset 0 0 3px 3px #FFB6C1;
        }

        .btn-incorrect:active {
            box-shadow: 0 4px 3px 1px #FFF0F5, 0 6px 8px #FFB6C1, 0 -4px 4px #DC143C, 0 -6px 4px #FFF0F5, inset 0 0 5px 3px #DC143C, inset 0 0 30px #FFB6C1;
        }

        .btn-incorrect:focus {
            box-shadow: 0 4px 3px 1px #FFF0F5, 0 6px 8px #FFB6C1, 0 -4px 4px #DC143C, 0 -6px 4px #FFF0F5, inset 0 0 5px 3px #DC143C, inset 0 0 30px #FFB6C1;
        }

        .btn-primary {
            background: #007bff;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .button-group {
            margin-top: 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .celebration {
            background: #ffffff;
            color: #333;
            border: 2px solid #fc403a;
        }

        .celebration h2 {
            color: #fc403a;
        }

        .score-display {
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            color: white;
        }

        .score-numbers {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 10px;
        }

        .stat-item-button {
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
            cursor: pointer;
            width: 150px;
            height: 50px;
            background-image: linear-gradient(to top, #D8D9DB 0%, #fff 80%, #FDFDFD 100%);
            border-radius: 30px;
            border: 1px solid #8F9092;
            transition: all 0.2s ease;
            font-family: "Source Sans Pro", sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #606060;
            text-shadow: 0 1px #fff;
        }

        .stat-item-button:hover {
            box-shadow: 0 4px 3px 1px #FCFCFC, 0 6px 8px #D6D7D9, 0 -4px 4px #CECFD1, 0 -6px 4px #FEFEFE, inset 0 0 3px 3px #CECFD1;
        }

        .stat-item-button:active {
            box-shadow: 0 4px 3px 1px #FCFCFC, 0 6px 8px #D6D7D9, 0 -4px 4px #CECFD1, 0 -6px 4px #FEFEFE, inset 0 0 5px 3px #999, inset 0 0 30px #aaa;
        }

        .stat-item-button:focus {
            box-shadow: 0 4px 3px 1px #FCFCFC, 0 6px 8px #D6D7D9, 0 -4px 4px #CECFD1, 0 -6px 4px #FEFEFE, inset 0 0 5px 3px #999, inset 0 0 30px #aaa;
        }
            .container {
                padding: 20px;
            }
            
            .stats-grid {
                gap: 10px;
            }
            
            .stat-item {
                width: 120px;
                height: 70px;
            }
            
            .stat-number {
                font-size: 1.2rem;
            }
            
            .stat-label {
                font-size: 0.8rem;
            }
            
            .evaluation-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .stat-item-button {
                width: 120px;
                height: 45px;
                font-size: 12px;
            }
        }

        .start-button {
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
            cursor: pointer;
            width: 150px;
            height: 50px;
            background-image: linear-gradient(to top, #D8D9DB 0%, #fff 80%, #FDFDFD 100%);
            border-radius: 30px;
            border: 1px solid #8F9092;
            transition: all 0.2s ease;
            font-family: "Source Sans Pro", sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: #606060;
            text-shadow: 0 1px #fff;
            margin-top: 20px;
        }

        .start-button:hover {
            box-shadow: 0 4px 3px 1px #FCFCFC, 0 6px 8px #D6D7D9, 0 -4px 4px #CECFD1, 0 -6px 4px #FEFEFE, inset 0 0 3px 3px #CECFD1;
        }

        .start-button:active {
            box-shadow: 0 4px 3px 1px #FCFCFC, 0 6px 8px #D6D7D9, 0 -4px 4px #CECFD1, 0 -6px 4px #FEFEFE, inset 0 0 5px 3px #999, inset 0 0 30px #aaa;
        }

        .start-button:focus {
            box-shadow: 0 4px 3px 1px #FCFCFC, 0 6px 8px #D6D7D9, 0 -4px 4px #CECFD1, 0 -6px 4px #FEFEFE, inset 0 0 5px 3px #999, inset 0 0 30px #aaa;
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="https://i.postimg.cc/fb8Q8KFX/Whats-App-Image-2025-07-06-at-14-08-31.jpg" alt="–õ–æ–≥–æ—Ç–∏–ø –∫–æ–º–ø–∞–Ω–∏–∏" class="logo" />
        <h1>–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Å–∏—Å—Ç–µ–º–µ BI</h1>

        <div class="stats">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalQuestions">0</div>
                    <div class="stat-label">–í–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="correctAnswers">0</div>
                    <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="incorrectAnswers">0</div>
                    <div class="stat-label">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="successRate">0%</div>
                    <div class="stat-label">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
                </div>
            </div>
        </div>

        <div id="mainScreen">
            <div style="display: flex; justify-content: center; margin-top: 20px;">
                <button class="stat-item-button" onclick="startExam()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            </div>
            <address style="text-align: center; font-size: 0.875rem; color: #666; opacity: 0.8; margin-top: 30px;">
                ¬© 2025 –°–∏–∑—å–∫–æ –°—Ç–∞–Ω–∏—Å–ª–∞–≤
            </address>
        </div>

        <div id="examScreen" class="exam-section">
            <div id="questionContainer"></div>

            <div class="evaluator-section" id="evaluatorSection" style="display: none">
                <div class="evaluator-title">üìã –û—Ü–µ–Ω–∫–∞ —ç–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä–∞</div>
                <div class="evaluation-result" id="evaluationResult"></div>
                <div class="evaluation-buttons">
                    <button class="btn btn-correct" onclick="evaluateAnswer(true)">
                        ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
                    </button>
                    <button class="btn btn-incorrect" onclick="evaluateAnswer(false)">
                        ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
                    </button>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-success" id="completeBtn" onclick="completeTest()" style="display: none" disabled>
                    –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
                </button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            {
                type: '–í–æ–ø—Ä–æ—Å',
                text: '–î–ª—è —á–µ–≥–æ –Ω—É–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ BI? –û–±—ä—è—Å–Ω–∏—Ç–µ.',
            },
            {
                type: '–í–æ–ø—Ä–æ—Å',
                text: '–° —á–µ–º –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º—É BI? –ù–∞ —á—Ç–æ –ø–æ—Ö–æ–∂ –µ–µ –ø—Ä–∏–Ω—Ü–∏–ø?',
            },
            {
                type: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π',
                text: '–ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ, –∫–∞–∫ –ø–æ–ø–∞—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É BI.',
            },
            {
                type: '–í–æ–ø—Ä–æ—Å',
                text: '–ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã BI?',
            },
            {
                type: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π',
                text: '–ß—Ç–æ —Ç–∞–∫–æ–µ –¥—ç—à–±–æ—Ä–¥? –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≤–∏–¥–∂–µ—Ç–æ–≤.',
            },
            {
                type: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π',
                text: '–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–≤–æ–¥–Ω—ã–µ –æ—Ç—á–µ—Ç—ã, –≥–¥–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è? –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ.',
            },
            {
                type: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π',
                text: '–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–¥–∫—É –ø–æ–¥ —Å–µ–±—è?',
            },
            {
                type: '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π',
                text: '–ß—Ç–æ —Ç–∞–∫–æ–µ —ç—Ç–∞–∂–∏ –∏–Ω—Å–∞–π—Ç? –ö–∞–∫ –ø–æ–ø–∞—Å—Ç—å –≤ —ç—Ç–∞–∂–∏ –∏–Ω—Å–∞–π—Ç? –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ.',
            },
        ];

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Google Sheets
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbykOf-u3wye3_zEzB8VdFq77Mxk17YPWmlF9cgn6bs5oJLZSlLwnAEitzAHo6M6tJ-C/exec';
        
        let currentQuestionIndex = 0;
        let currentTestAnswered = 0;
        let currentTestCorrect = 0;
        let currentTestIncorrect = 0;
        let testStartTime = null;
        let totalAnswered = parseInt(localStorage.getItem('totalAnswered') || '0');
        let correctAnswers = parseInt(localStorage.getItem('correctAnswers') || '0');
        let incorrectAnswers = parseInt(localStorage.getItem('incorrectAnswers') || '0');
        let isQuestionEvaluated = false;
        let answersLog = JSON.parse(localStorage.getItem('answersLog') || '[]');

        function initializeApp() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å –Ω—É–ª–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞
            updateStats();
        }

        function updateProgress() {
            // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö
        }

        function updateStats() {
            const totalQuestionsEl = document.getElementById('totalQuestions');
            const correctAnswersEl = document.getElementById('correctAnswers');
            const incorrectAnswersEl = document.getElementById('incorrectAnswers');
            const successRateEl = document.getElementById('successRate');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¢–ï–ö–£–©–ï–ì–û —Ç–µ—Å—Ç–∞, –∞ –Ω–µ –æ–±—â–∏–µ
            if (totalQuestionsEl) totalQuestionsEl.textContent = currentTestAnswered;
            if (correctAnswersEl) correctAnswersEl.textContent = currentTestCorrect;
            if (incorrectAnswersEl) incorrectAnswersEl.textContent = currentTestIncorrect;
            if (successRateEl) {
                // –ü—Ä–æ–≥—Ä–µ—Å—Å = —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ —Ç–µ—Å—Ç–∞ –ø—Ä–æ–π–¥–µ–Ω–æ
                const progressPercent = Math.round((currentTestAnswered / questions.length) * 100);
                successRateEl.textContent = progressPercent + '%';
            }
        }

        function startExam() {
            currentQuestionIndex = 0;
            isQuestionEvaluated = false;
            
            // –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ç–µ—Å—Ç–∞
            currentTestAnswered = 0;
            currentTestCorrect = 0;
            currentTestIncorrect = 0;
            
            // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∞
            testStartTime = new Date();
            
            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('examScreen').style.display = 'block';
            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showFinalResults();
                return;
            }

            const question = questions[currentQuestionIndex];
            const questionContainer = document.getElementById('questionContainer');
            
            questionContainer.innerHTML = `
                <div class="question-card">
                    <div class="question-type">
                        ${question.type} –≤–æ–ø—Ä–æ—Å ${currentTestAnswered + 1}/${questions.length}
                    </div>
                    <div class="question-text">${question.text}</div>
                    <div class="stats-progress-bar" style="margin-top: 20px;">
                        <div class="stats-progress-fill" style="width: ${Math.round((currentTestAnswered / questions.length) * 100)}%;"></div>
                    </div>
                </div>
            `;

            document.getElementById('evaluatorSection').style.display = 'block';
            document.getElementById('evaluationResult').style.display = 'none';
            
            isQuestionEvaluated = false;
            const completeBtn = document.getElementById('completeBtn');
            completeBtn.disabled = true;
            
            if (currentQuestionIndex < questions.length - 1) {
                completeBtn.style.display = 'none';
            } else {
                completeBtn.style.display = 'inline-block';
                completeBtn.textContent = '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ';
            }
        }

        function evaluateAnswer(isCorrect) {
            if (isQuestionEvaluated) return;
            
            isQuestionEvaluated = true;
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –ü–û–°–õ–ï –æ—Ç–≤–µ—Ç–∞
            currentTestAnswered++;
            totalAnswered++;
            
            const question = questions[currentQuestionIndex];
            answersLog.push({
                question: question.text,
                result: isCorrect ? '–ü—Ä–∞–≤–∏–ª—å–Ω–æ' : '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ',
                timestamp: new Date().toISOString(),
            });
            
            localStorage.setItem('answersLog', JSON.stringify(answersLog));
            
            const resultDiv = document.getElementById('evaluationResult');
            if (isCorrect) {
                currentTestCorrect++;
                correctAnswers++;
                resultDiv.textContent = '‚úÖ –û—Ç–≤–µ—Ç –∑–∞—Å—á–∏—Ç–∞–Ω –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π';
                resultDiv.className = 'evaluation-result result-correct';
            } else {
                currentTestIncorrect++;
                incorrectAnswers++;
                resultDiv.textContent = '‚ùå –û—Ç–≤–µ—Ç –∑–∞—Å—á–∏—Ç–∞–Ω –∫–∞–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π';
                resultDiv.className = 'evaluation-result result-incorrect';
            }
            
            resultDiv.style.display = 'block';
            
            localStorage.setItem('totalAnswered', totalAnswered.toString());
            localStorage.setItem('correctAnswers', correctAnswers.toString());
            localStorage.setItem('incorrectAnswers', incorrectAnswers.toString());
            
            updateStats();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ü–û–°–õ–ï –æ—Ç–≤–µ—Ç–∞
            const progressBar = document.querySelector('.stats-progress-fill');
            if (progressBar) {
                progressBar.style.width = Math.round((currentTestAnswered / questions.length) * 100) + '%';
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            setTimeout(() => {
                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    showQuestion();
                } else {
                    document.getElementById('completeBtn').disabled = false;
                }
            }, 1500);
        }

        function completeTest() {
            if (!isQuestionEvaluated && currentQuestionIndex < questions.length) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –æ—Ü–µ–Ω–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–≤–µ—Ç');
                return;
            }
            showFinalResults();
        }

        function showFinalResults() {
            const totalQuestions = questions.length;
            const percent = currentTestAnswered > 0 ? Math.round((currentTestCorrect / currentTestAnswered) * 100) : 0;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ Google Sheets
            saveToGoogleSheets();
            
            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('examScreen').style.display = 'none';
            
            const container = document.querySelector('.container');
            container.innerHTML = `
                <div class="question-card celebration" style="margin-top: 40px;">
                    <h2 style="color: #fc403a; margin-bottom: 20px;">üéâ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
                    <div style="font-size: 1.5rem; color: #333; font-weight: 700; margin-bottom: 30px; text-align: center;">
                        –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <span style="color: #fc403a;">${percent}%</span>
                    </div>
                    <div class="score-display" style="background: ${percent >= 70 ? '#28a745' : '#dc3545'}; margin: 20px 0;">
                        <h4>–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                        <div class="score-numbers">${currentTestCorrect}/${currentTestAnswered} –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                    </div>
                    <div style="font-size: 1.1rem; color: #333; margin-bottom: 20px;">
                        –í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤: <b>${currentTestAnswered} –∏–∑ ${totalQuestions}</b><br>
                        –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <b>${currentTestCorrect}</b><br>
                        –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <b>${currentTestIncorrect}</b><br>
                        –ü—Ä–æ–≥—Ä–µ—Å—Å: <b>${Math.round((currentTestAnswered / totalQuestions) * 100)}%</b>
                    </div>
                    <div style="color: #28a745; font-weight: 600; margin: 10px 0;">
                        ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Google –¢–∞–±–ª–∏—Ü–µ
                    </div>
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button class="stat-item-button" onclick="downloadDetailedResults()">üìä –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                        <button class="stat-item-button" onclick="restartTest()">üîÑ –ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
                        <button class="stat-item-button" onclick="goToMainScreen()">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</button>
                    </div>
                </div>
            `;
        }

        function downloadDetailedResults() {
            if (answersLog.length === 0) {
                alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è. –ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç —Å–Ω–∞—á–∞–ª–∞.');
                return;
            }
            
            const csvRows = [['–ù–æ–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞', '–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞', '–†–µ–∑—É–ª—å—Ç–∞—Ç']];
            
            answersLog.forEach((entry, index) => {
                csvRows.push([
                    index + 1,
                    `"${entry.question.replace(/"/g, '""')}"`,
                    entry.result
                ]);
            });

            const csvContent = csvRows.map(row => row.join(',')).join('\n');
            downloadCSV(csvContent, '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã_—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è_BI');
        }

        function restartTest() {
            // –°–±—Ä–æ—Å –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
            localStorage.removeItem('totalAnswered');
            localStorage.removeItem('correctAnswers');
            localStorage.removeItem('incorrectAnswers');
            localStorage.removeItem('answersLog');
            
            // –°–±—Ä–æ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            totalAnswered = 0;
            correctAnswers = 0;
            incorrectAnswers = 0;
            currentQuestionIndex = 0;
            isQuestionEvaluated = false;
            answersLog = [];
            
            // –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ
            startExam();
        }

        function goToMainScreen() {
            // –°–±—Ä–æ—Å –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
            localStorage.removeItem('totalAnswered');
            localStorage.removeItem('correctAnswers');
            localStorage.removeItem('incorrectAnswers');
            localStorage.removeItem('answersLog');
            
            // –°–±—Ä–æ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            totalAnswered = 0;
            correctAnswers = 0;
            incorrectAnswers = 0;
            currentQuestionIndex = 0;
            isQuestionEvaluated = false;
            answersLog = [];
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é
            location.reload();
        }

        function downloadCSV(csvContent, baseFileName) {
            console.log('–ù–∞—á–∏–Ω–∞–µ–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞...');
            
            try {
                const BOM = '\uFEFF';
                const csvWithBOM = BOM + csvContent;
                const now = new Date();
                const timestamp = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}-${String(now.getMinutes()).padStart(2, '0')}`;
                const fileName = `${baseFileName}_${timestamp}.csv`;

                // –°–æ–∑–¥–∞–µ–º blob
                const blob = new Blob([csvWithBOM], { type: 'text/csv;charset=utf-8;' });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É File System Access API (–¥–ª—è Chrome –∏ –Ω–æ–≤—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤)
                if ('showSaveFilePicker' in window) {
                    console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º File System Access API');
                    
                    window.showSaveFilePicker({
                        suggestedName: fileName,
                        types: [{
                            description: 'CSV files',
                            accept: { 'text/csv': ['.csv'] }
                        }]
                    }).then(async (fileHandle) => {
                        const writable = await fileHandle.createWritable();
                        await writable.write(blob);
                        await writable.close();
                        alert('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
                    }).catch((error) => {
                        if (error.name !== 'AbortError') {
                            console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–ª–∏ –æ—à–∏–±–∫–∞:', error);
                            fallbackDownload();
                        }
                    });
                    return;
                }
                
                // Fallback –¥–ª—è –¥—Ä—É–≥–∏—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                function fallbackDownload() {
                    console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è');
                    
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    
                    link.href = url;
                    link.download = fileName;
                    link.style.display = 'none';
                    
                    document.body.appendChild(link);
                    link.click();
                    
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(url);
                    }, 100);
                    
                    alert('–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –ø–∞–ø–∫—É "–ó–∞–≥—Ä—É–∑–∫–∏"');
                }
                
                fallbackDownload();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏:', error);
                
                // –ü–æ—Å–ª–µ–¥–Ω–∏–π fallback - –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    z-index: 10000;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                `;
                
                const modal = document.createElement('div');
                modal.style.cssText = `
                    background: white;
                    padding: 20px;
                    border-radius: 10px;
                    width: 80%;
                    max-width: 600px;
                    max-height: 80%;
                    overflow: auto;
                `;
                
                modal.innerHTML = `
                    <h3 style="margin-bottom: 15px;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
                    <p style="margin-bottom: 15px;">–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª .csv:</p>
                    <textarea style="width: 100%; height: 300px; font-family: monospace; padding: 10px;" readonly>${csvContent}</textarea>
                    <div style="margin-top: 15px; text-align: center;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="padding: 10px 20px; background: #fc403a; color: white; border: none; border-radius: 5px; cursor: pointer;">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                `;
                
                overlay.appendChild(modal);
                document.body.appendChild(overlay);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
                const textarea = modal.querySelector('textarea');
                textarea.focus();
                textarea.select();
            }
        }

        function resetTest() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) {
                localStorage.removeItem('totalAnswered');
                localStorage.removeItem('correctAnswers');
                localStorage.removeItem('incorrectAnswers');
                localStorage.removeItem('answersLog');
                
                // –°–±—Ä–æ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
                totalAnswered = 0;
                correctAnswers = 0;
                incorrectAnswers = 0;
                currentQuestionIndex = 0;
                isQuestionEvaluated = false;
                answersLog = [];
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                updateStats();
                updateProgress();
                
                alert('–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ —Å–±—Ä–æ—à–µ–Ω!');
            }
        }

        function saveToGoogleSheets() {
            if (!GOOGLE_SCRIPT_URL || GOOGLE_SCRIPT_URL === '–í–°–¢–ê–í–¨–¢–ï_–°–Æ–î–ê_URL_–í–ê–®–ï–ì–û_GOOGLE_APPS_SCRIPT') {
                console.log('Google Apps Script URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
                return;
            }

            const testEndTime = new Date();
            const testDuration = Math.round((testEndTime - testStartTime) / 1000); // –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
            
            const testData = {
                testInfo: {
                    startTime: testStartTime.toLocaleString('ru-RU'),
                    endTime: testEndTime.toLocaleString('ru-RU'),
                    duration: `${Math.floor(testDuration / 60)}:${(testDuration % 60).toString().padStart(2, '0')}`,
                    totalQuestions: questions.length,
                    answeredQuestions: currentTestAnswered,
                    correctAnswers: currentTestCorrect,
                    incorrectAnswers: currentTestIncorrect,
                    successRate: currentTestAnswered > 0 ? Math.round((currentTestCorrect / currentTestAnswered) * 100) : 0,
                    progress: Math.round((currentTestAnswered / questions.length) * 100)
                },
                answers: answersLog.map((answer, index) => ({
                    questionNumber: index + 1,
                    questionType: questions[index] ? questions[index].type : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ',
                    questionText: answer.question,
                    userAnswer: answer.result,
                    timestamp: new Date(answer.timestamp).toLocaleString('ru-RU')
                }))
            };

            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Google Sheets:', testData);
            console.log('URL –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:', GOOGLE_SCRIPT_URL);

            // –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –†–ê–ë–û–ß–ò–ô –°–ü–û–°–û–ë –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ - —á–µ—Ä–µ–∑ –Ω–µ–≤–∏–¥–∏–º—ã–π iframe
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.name = 'googleSheetSubmit';
            document.body.appendChild(iframe);

            // –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ POST –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ iframe
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = GOOGLE_SCRIPT_URL;
            form.target = 'googleSheetSubmit'; // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ iframe
            form.style.display = 'none';
            
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'data';
            input.value = JSON.stringify(testData);
            
            form.appendChild(input);
            document.body.appendChild(form);
            
            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ iframe...');
            form.submit();
            
            // –£–¥–∞–ª—è–µ–º —Ñ–æ—Ä–º—É –∏ iframe —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
            setTimeout(() => {
                if (document.body.contains(form)) {
                    document.body.removeChild(form);
                }
                if (document.body.contains(iframe)) {
                    document.body.removeChild(iframe);
                }
                console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google Sheets —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É');
            }, 3000);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #28a745;
                color: white;
                padding: 15px;
                border-radius: 5px;
                z-index: 10000;
                font-weight: 600;
            `;
            notification.textContent = 'üìä –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Google –¢–∞–±–ª–∏—Ü—É...';
            document.body.appendChild(notification);

            setTimeout(() => {
                if (document.body.contains(notification)) {
                    notification.textContent = '‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google –¢–∞–±–ª–∏—Ü—É!';
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 2000);
                }
            }, 3000);
        }

        document.addEventListener('DOMContentLoaded', function () {
            initializeApp();
        });
    </script>
</body>
</html>
